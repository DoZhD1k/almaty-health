# –†–∞—Å—á–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π –º–µ–∂–¥—É –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–º–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è–º–∏

## –§–æ—Ä–º—É–ª–∞ –ì–∞–≤–µ—Ä—Å–∏–Ω—É—Å–æ–≤ (Haversine Formula)

–î–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π –º–µ–∂–¥—É –ú–û –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **—Ñ–æ—Ä–º—É–ª–∞ –ì–∞–≤–µ—Ä—Å–∏–Ω—É—Å–æ–≤** ‚Äî —Ç–æ—á–Ω—ã–π –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É –¥–≤—É–º—è —Ç–æ—á–∫–∞–º–∏ –Ω–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ —Å—Ñ–µ—Ä—ã –ø–æ –∏—Ö –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º.

### –ü–æ—á–µ–º—É —ç—Ç–∞ —Ñ–æ—Ä–º—É–ª–∞?

1. **–£—á–∏—Ç—ã–≤–∞–µ—Ç –∫—Ä–∏–≤–∏–∑–Ω—É –ó–µ–º–ª–∏** ‚Äî –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –ø—Ä–æ—Å—Ç–æ–π —Ç–µ–æ—Ä–µ–º—ã –ü–∏—Ñ–∞–≥–æ—Ä–∞, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ –ø–ª–æ—Å–∫–æ—Å—Ç–∏
2. **–í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å** ‚Äî –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å –º–µ–Ω–µ–µ 0.5% –¥–ª—è —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π –¥–æ 1000 –∫–º
3. **–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –≥–æ—Ä–æ–¥—Å–∫–∏—Ö —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π** ‚Äî –∏–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –ê–ª–º–∞—Ç—ã –∏ –æ–∫—Ä–µ—Å—Ç–Ω–æ—Å—Ç–µ–π

### –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ñ–æ—Ä–º—É–ª–∞

```
a = sin¬≤(ŒîœÜ/2) + cos(œÜ1) √ó cos(œÜ2) √ó sin¬≤(ŒîŒª/2)
c = 2 √ó atan2(‚àöa, ‚àö(1-a))
d = R √ó c
```

–ì–¥–µ:

- **œÜ (phi)** ‚Äî —à–∏—Ä–æ—Ç–∞ (latitude) –≤ —Ä–∞–¥–∏–∞–Ω–∞—Ö
- **Œª (lambda)** ‚Äî –¥–æ–ª–≥–æ—Ç–∞ (longitude) –≤ —Ä–∞–¥–∏–∞–Ω–∞—Ö
- **R** ‚Äî —Ä–∞–¥–∏—É—Å –ó–µ–º–ª–∏ (6371 –∫–º)
- **ŒîœÜ** ‚Äî —Ä–∞–∑–Ω–∏—Ü–∞ —à–∏—Ä–æ—Ç
- **ŒîŒª** ‚Äî —Ä–∞–∑–Ω–∏—Ü–∞ –¥–æ–ª–≥–æ—Ç
- **d** ‚Äî –∏—Ç–æ–≥–æ–≤–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –≤ –∫–∏–ª–æ–º–µ—Ç—Ä–∞—Ö

### –ü—Ä–∏–º–µ—Ä —Ä–∞—Å—á–µ—Ç–∞

–î–ª—è –¥–≤—É—Ö –ú–û –≤ –ê–ª–º–∞—Ç—ã:

**–ú–û 1:** 43.2566¬∞N, 76.9286¬∞E  
**–ú–û 2:** 43.2200¬∞N, 76.8512¬∞E

```typescript
const distance = calculateDistance(43.2566, 76.9286, 43.22, 76.8512);
// –†–µ–∑—É–ª—å—Ç–∞—Ç: ~7.2 –∫–º
```

### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ –∫–∞—Ä—Ç–µ

–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –¥–≤—É—Ö –º–µ—Å—Ç–∞—Ö:

1. **–í —Å–ø–∏—Å–∫–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤** ‚Äî –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Å –∫–∏–ª–æ–º–µ—Ç—Ä–∞–º–∏ –∏ –≤—Ä–µ–º–µ–Ω–µ–º –≤ –ø—É—Ç–∏
2. **–ù–∞ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π –∫–∞—Ä—Ç–µ** ‚Äî –≤–∏–∑—É–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–∞ –º–µ–∂–¥—É –ú–û

#### –ö–∞—Ä—Ç–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:

- üî¥ **–ö—Ä–∞—Å–Ω—ã–π –º–∞—Ä–∫–µ—Ä** ‚Äî –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –ú–û (–∏—Å—Ç–æ—á–Ω–∏–∫)
- üü¢ **–ó–µ–ª–µ–Ω—ã–π –º–∞—Ä–∫–µ—Ä** ‚Äî –º–µ–Ω–µ–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –ú–û (–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ)
- üìç **–°–∏–Ω—è—è –ø—É–Ω–∫—Ç–∏—Ä–Ω–∞—è –ª–∏–Ω–∏—è** ‚Äî –º–∞—Ä—à—Ä—É—Ç –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- üìè **–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –∏ –≤—Ä–µ–º—è** ‚Äî –≤ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–º –±–ª–æ–∫–µ

### –†–∞—Å—á–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –≤ –ø—É—Ç–∏

–ü—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ:

```typescript
const travelTime = Math.round((distance / 40) * 60); // –≤ –º–∏–Ω—É—Ç–∞—Ö
```

**–ü—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—è:**

- –°—Ä–µ–¥–Ω—è—è —Å–∫–æ—Ä–æ—Å—Ç—å –≤ –≥–æ—Ä–æ–¥–µ: **40 –∫–º/—á**
- –£—á–∏—Ç—ã–≤–∞–µ—Ç —Å–≤–µ—Ç–æ—Ñ–æ—Ä—ã, –ø—Ä–æ–±–∫–∏, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏

### –ö–∞–∫ –æ—Ç–∫—Ä—ã—Ç—å –∫–∞—Ä—Ç—É

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É **"–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏"**
2. –í —Ä–∞–∑–¥–µ–ª–µ **"–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é"** –Ω–∞–π–¥–∏—Ç–µ –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –ú–û
3. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"–ù–∞ –∫–∞—Ä—Ç–µ"** —Ä—è–¥–æ–º —Å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–º –ú–û
4. –û—Ç–∫—Ä–æ–µ—Ç—Å—è –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π –∫–∞—Ä—Ç–æ–π –º–∞—Ä—à—Ä—É—Ç–∞

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

**–§–∞–π–ª—ã:**

- `lib/utils/distance.ts` ‚Äî —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å—á–µ—Ç–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π
- `components/recommendations/redirection-map.tsx` ‚Äî –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–∞—Ä—Ç—ã
- `components/recommendations/redirection-recommendations.tsx` ‚Äî —Å–ø–∏—Å–æ–∫ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

**–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏:**

- **MapLibre GL** ‚Äî –¥–ª—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–∞—Ä—Ç
- **OpenStreetMap** ‚Äî –∏—Å—Ç–æ—á–Ω–∏–∫ –∫–∞—Ä—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ "–ø–æ –ø—Ä—è–º–æ–π"** ‚Äî –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –¥–æ—Ä–æ–≥–∏
2. **–ü—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è** ‚Äî —Ä–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –∏–∑-–∑–∞ —Ç—Ä–∞—Ñ–∏–∫–∞
3. **–î–ª—è —Ç–æ—á–Ω–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞** ‚Äî —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, OSRM)
- [ ] –£—á–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –≤ –ø—É—Ç–∏ —Å —É—á–µ—Ç–æ–º –ø—Ä–æ–±–æ–∫
- [ ] –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –º–∞—Ä—à—Ä—É—Ç–æ–≤ –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
